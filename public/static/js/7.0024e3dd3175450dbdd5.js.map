{"version":3,"sources":["webpack:///src/views/naire.vue","webpack:///./src/views/naire.vue?c023","webpack:///./src/views/naire.vue"],"names":["naire","data","n_id","dataArr","questions","options","selectData","answer","checkData","loading","dData","single","multiple","methods","getQuestion","id","_this","this","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","Object","api","then","res","console","log","n_status","toast","$router","push","stop","submit","_this2","_callee2","checkId","flag","arr","_context2","filter","d","forEach","item","i","q_id","indexOf","length","abrupt","concat","o_id","error_code","catch","err","duoxuan","_this3","q_type","status","_status","removeEmpty","brr","map","val","index","undefined","computed","singleNum","multipleNum","created","_this4","_callee3","_context3","$route","params","mounted","views_naire","render","_vm","_h","$createElement","_c","_self","directives","name","rawName","value","expression","staticClass","_v","_s","n_title","_l","q_isrequire","staticStyle","color","_e","q_content","ref","refInFor","model","callback","$$v","$set","opt","attrs","label","o_value","_id","type","round","on","click","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/7.0024e3dd3175450dbdd5.js","sourcesContent":["<template>\r\n  <div class=\"container\" v-loading=\"loading\">\r\n    <div class=\"title\">\r\n      {{dataArr.n_title}}\r\n    </div>\r\n\r\n    <div class=\"main\">\r\n      <div v-for=\"(item,i) in questions\" class=\"item\">\r\n        <p><span style=\"color: red;\" v-if=\"item.q_isrequire == 1\">*</span>{{i+1}}.{{item.q_content}}\r\n          <span style=\"color: f6f6f6!important;\">({{item.q_type}})</span></p>\r\n\r\n        <el-radio-group v-model=\"selectData[i]\" v-if=\"item.q_type == '单选'\" ref=\"radioM\">\r\n          <div v-for=\"(opt,index) in item.option\" class=\"opt\">\r\n            <el-radio :label=\"opt\">{{opt.o_value}}</el-radio>\r\n          </div>\r\n        </el-radio-group>\r\n\r\n        <el-checkbox-group v-model=\"checkData\" v-if=\"item.q_type == '多选'\" :ref=\"'checkbox'+item._id\">\r\n          <div v-for=\"(opt,index) in item.option\">\r\n            <el-checkbox :label=\"opt\">{{opt.o_value}}</el-checkbox>\r\n          </div>\r\n        </el-checkbox-group>\r\n\r\n      </div>\r\n    </div>\r\n    <el-button type=\"primary\" round @click=\"submit()\">提交</el-button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    post,\r\n    get\r\n  } from '../axios/api.js'\r\n  import {\r\n    errorToast,\r\n    successToast\r\n  } from '@/common/toast'\r\n  export default {\r\n    data() {\r\n      return {\r\n        n_id: '',\r\n        dataArr: '',\r\n        questions: '',\r\n        options: [],\r\n        selectData: [],\r\n        answer: [],\r\n        checkData: [], //选中的多选题答案\r\n        loading: true,\r\n        dData: [], //多选题的q_id\r\n        single: [], //单选\r\n        multiple: [] //多选\r\n      }\r\n    },\r\n    methods: {\r\n      // 获取\r\n      async getQuestion(id) {\r\n        await get('/naire/' + id)\r\n          .then(res => {\r\n            console.log(res)\r\n            if (!res) {\r\n              errorToast('没有找到此问卷')\r\n              this.$router.push('/home/list')\r\n              return\r\n            }\r\n            if (res.n_status == 0) {\r\n              errorToast('该问卷已截止')\r\n              this.$router.push('/home/list')\r\n              return\r\n            }\r\n            this.dataArr = res\r\n            this.questions = res.questions\r\n            this.loading = false\r\n          })\r\n      },\r\n\r\n      // 提交\r\n      async submit() {\r\n        let single = this.selectData.filter(d => d) // 过滤数组中的empty项\r\n        let checkData = this.checkData.filter(d => d)\r\n        let checkId = [];\r\n        console.log(this.checkData)\r\n        this.checkData.forEach((item, i) => {\r\n          checkId.push(item.q_id)\r\n        })\r\n        let flag = true\r\n        this.dData.forEach((item, i) => {\r\n          if (checkId.indexOf(item) === -1) {\r\n            flag = false\r\n          }\r\n        })\r\n        console.log(flag)\r\n        if (single.length < this.single.length || !flag) {\r\n          return errorToast('请完整填写再提交')\r\n        }\r\n\r\n        let arr = [];\r\n        arr = single.concat(checkData)\r\n        arr.forEach((item, i) => {\r\n          item.o_id = item.id\r\n          item.n_id = this.n_id\r\n          delete item['id']\r\n        })\r\n        // if (arr.length < this.questions.length) {\r\n        //   return errorToast('请完整填写再提交')\r\n        // }\r\n        console.log(arr)\r\n        await post('/naire/answer', arr)\r\n          .then((res) => {\r\n            if (!res.error_code === 0) {\r\n              successToast('内部错误')\r\n            }\r\n            successToast('提交成功')\r\n            this.$router.push('/home/list')\r\n          })\r\n          .catch((err) => {\r\n            errorToast(err)\r\n          })\r\n      },\r\n\r\n      // 分离 单选和多选数组\r\n      duoxuan() {\r\n        this.questions.forEach((item, i) => {\r\n          if (item.q_type == '多选') {\r\n            this.multiple.push(item)\r\n            this.dData.push(item.id)\r\n          }\r\n          if (item.q_type == '单选') {\r\n            this.single.push(item)\r\n          }\r\n        })\r\n      },\r\n\r\n      //\r\n      status(status) {\r\n        if (status == 0) {\r\n          errorToast('该问卷已截止')\r\n          this.$router.push('/home/list')\r\n        }\r\n      },\r\n\r\n      // 去出数组空值\r\n      removeEmpty(arr) {\r\n        var brr = [];\r\n        arr.map(function(val, index) {\r\n          //过滤规则为，不为空串、不为null、不为undefined，也可自行修改\r\n          if (val !== \"\" && val != undefined) {\r\n            brr.push(val);\r\n          }\r\n        });\r\n        return brr;\r\n      },\r\n    },\r\n\r\n    computed: {\r\n      singleNum() {\r\n        let i = 0\r\n        this.questions.forEach((item, i) => {\r\n          if (item.q_type == '单选') {\r\n            i = i + 1\r\n          }\r\n        })\r\n        return i\r\n      },\r\n      multipleNum() {\r\n        let i = 0\r\n        this.questions.forEach((item, i) => {\r\n          if (item.q_type == '多选') {\r\n            i = i + 1\r\n          }\r\n        })\r\n        return i\r\n      }\r\n    },\r\n\r\n    async created() {\r\n      this.n_id = this.$route.params.id\r\n      await this.getQuestion(this.$route.params.id)\r\n      // console.log(this.$refs.rad)  ref作为渲染结果被创建 在初始渲染时访问不到他\r\n      this.duoxuan()\r\n      console.log(this.single)\r\n    },\r\n    mounted() {\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped=\"scoped\">\r\n  @media screen and (min-width: 700px) {\r\n    .container {\r\n      margin-top: 40px;\r\n      width: 700px;\r\n      height: 100%;\r\n      padding: 40px;\r\n      background: #fff;\r\n      border: 1px solid #eaeaea;\r\n      box-shadow: 0 0 25px #cac6c6;\r\n    }\r\n\r\n    .title {\r\n      width: 100%;\r\n      height: 30px;\r\n      line-height: 30px;\r\n      font-size: 24px;\r\n      text-align: center;\r\n    }\r\n\r\n    .main {\r\n      margin-top: 20px;\r\n    }\r\n\r\n    .el-button {\r\n      margin-top: 20px;\r\n    }\r\n  }\r\n\r\n  @media screen and (max-width: 700px) {\r\n    .container {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    .title {\r\n      width: 100%;\r\n      height: 1.5rem;\r\n      line-height: 1.5rem;\r\n      font-size: 1rem;\r\n      text-align: center;\r\n    }\r\n\r\n    .main {\r\n      margin-top: 2rem;\r\n    }\r\n\r\n    .item {\r\n      margin: 15px;\r\n    }\r\n\r\n    .opt {}\r\n  }\r\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/naire.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"container\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"\\n    \"+_vm._s(_vm.dataArr.n_title)+\"\\n  \")]),_vm._v(\" \"),_c('div',{staticClass:\"main\"},_vm._l((_vm.questions),function(item,i){return _c('div',{staticClass:\"item\"},[_c('p',[(item.q_isrequire == 1)?_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\"*\")]):_vm._e(),_vm._v(_vm._s(i+1)+\".\"+_vm._s(item.q_content)+\"\\n        \"),_c('span',{staticStyle:{\"color\":\"f6f6f6!important\"}},[_vm._v(\"(\"+_vm._s(item.q_type)+\")\")])]),_vm._v(\" \"),(item.q_type == '单选')?_c('el-radio-group',{ref:\"radioM\",refInFor:true,model:{value:(_vm.selectData[i]),callback:function ($$v) {_vm.$set(_vm.selectData, i, $$v)},expression:\"selectData[i]\"}},_vm._l((item.option),function(opt,index){return _c('div',{staticClass:\"opt\"},[_c('el-radio',{attrs:{\"label\":opt}},[_vm._v(_vm._s(opt.o_value))])],1)}),0):_vm._e(),_vm._v(\" \"),(item.q_type == '多选')?_c('el-checkbox-group',{ref:'checkbox'+item._id,refInFor:true,model:{value:(_vm.checkData),callback:function ($$v) {_vm.checkData=$$v},expression:\"checkData\"}},_vm._l((item.option),function(opt,index){return _c('div',[_c('el-checkbox',{attrs:{\"label\":opt}},[_vm._v(_vm._s(opt.o_value))])],1)}),0):_vm._e()],1)}),0),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"round\":\"\"},on:{\"click\":function($event){return _vm.submit()}}},[_vm._v(\"提交\")])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-5078f328\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/naire.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5078f328\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./naire.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./naire.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./naire.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5078f328\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./naire.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5078f328\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/naire.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}