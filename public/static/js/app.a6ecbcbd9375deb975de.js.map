{"version":3,"sources":["webpack:///src/App.vue","webpack:///./src/App.vue?9e1e","webpack:///./src/App.vue","webpack:///./src/vuex/store.js","webpack:///./src/main.js","webpack:///./src/common/token.js","webpack:///./src/router/stage/naireRouter.js","webpack:///./src/router/stage/adminRouter.js","webpack:///./src/router/routes.js","webpack:///./src/router/index.js","webpack:///./src/axios/api.js"],"names":["App","name","components","mounted","document","getElementById","style","display","selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","staticClass","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","ssrContext","Vue","use","Vuex","store","Store","state","username","token","auth","mutations","getUsername","res","localStorage","setItem","getToken","Date","getTime","deleteToken","removeItem","flex","htmlwidth","documentElement","clientWidth","body","console","log","htmlDom","getElementsByTagName","fontSize","config","productionTip","prototype","$api","api","ElementUI","window","onresize","get","then","router","beforeEach","to","from","next","meta","requireAuth","getItem","path","query","redirect","fullPath","vm","h","$mount","naireRouter","icon","component","e","bind","children","hidden","Promise","all","adminRouter","routes","concat","toConsumableArray_default","Router","scrollBehavior","y","linkActiveClass","url","params","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","a","resolve","reject","data","catch","err","post","QS","stringify","put","arguments","length","undefined","method","baseURL","timeout","crossDomain","validateStatus","status","axios","create","interceptors","request","headers","Authorization","response","alert","push","error"],"mappings":"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","file":"static/js/app.a6ecbcbd9375deb975de.js","sourcesContent":["<template>\n  <div id=\"app\" class=\"container\">\n        <router-view></router-view>\n  </div>\n</template>\n\n<script>\n\nexport default {\n  name: 'App',\n  components: {\n\n  },\r\n  //app全部渲染出来后隐藏加载\r\n  mounted() {\r\n    document.getElementById('loader').style.display = 'none'\r\n  }\n}\n</script>\n\n<style>\nbody{\n  margin: 0;\n  padding: 0;\n  width: 100%;\n}\n#app{\n  margin: 0;\n  padding: 0;\n  font-size: 14px;\n  width: 100%;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\",attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-200e9556\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-200e9556\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-200e9556\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\n\r\n// 头部分类\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    username: '',\r\n    token: '',\r\n    auth: ''\r\n  },\r\n  mutations: {\r\n    getUsername(state, res) {\r\n      state.username = res\r\n      localStorage.setItem('username', res);\r\n    },\r\n    getToken(state, res) {\r\n      var exp = new Date().getTime() + 7200000\r\n      state.token = res.token\r\n      state.username = res.username\r\n      state.auth = res.auth\r\n      localStorage.setItem('token', res.token);\r\n      localStorage.setItem('username', res.username);\r\n      localStorage.setItem('auth', res.auth);\r\n    },\r\n    deleteToken(state, res) {\r\n      state.token = ''\r\n      state.username = null\n      state.auth = null\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('username');\r\n      localStorage.removeItem('auth');\r\n    }\r\n  }\r\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/vuex/store.js","// The Vue build version to load with the `import` command\r\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\r\nimport 'babel-polyfill'\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport App from './App'\r\nimport router from '@/router'\r\nimport api from './axios/api.js' // 导入api接口\r\nimport Vuex from 'vuex'\r\nimport store from './vuex/store.js'\r\nimport ElementUI from 'element-ui';\r\nimport 'element-ui/lib/theme-chalk/index.css';\r\nimport '@/assets/styles/index.scss'\r\nimport valitoken from '@/common/token.js'\n\r\nVue.config.productionTip = false\r\nVue.prototype.$api = api; // 将api挂载到vue的原型上复制代码\r\n\r\nVue.use(Vuex)\r\nVue.use(ElementUI);\r\n\r\n//rem适配\r\nfunction flex() {\r\n  let htmlwidth = document.documentElement.clientWidth || document.body.clientWidth;\r\n  console.log(\"屏幕宽度：\" + htmlwidth)\r\n  let htmlDom = document.getElementsByTagName('html')[0];\r\n  htmlDom.style.fontSize = htmlwidth / 20 + 'px';\n  console.log(htmlDom.style.fontSize)\r\n}\r\nflex();\r\nwindow.onresize = function() {\r\n  flex();\r\n}\n\n\r\nif (localStorage.token && localStorage.username) {\n  valitoken()\r\n  store.state.token = localStorage.token\r\n  store.state.username = localStorage.username\r\n}\r\n\r\n//用router的钩子函数 设置访问权限\r\nrouter.beforeEach((to, from, next) => {\r\n  // 获取 JWT Token\r\n  if (to.meta.requireAuth ){\r\n    // 判断该路由是否需要登录权限\r\n    if (localStorage.getItem('token')) {\r\n      // 通过获取当前的token是否存在\r\n      next()\r\n    } else {\r\n      next({\r\n        path: '/login',\r\n        query: {\r\n          redirect: to.fullPath\r\n        }\r\n        // 将跳转的路由path作为参数，登录成功后跳转到该路由\r\n      })\r\n    }\r\n  } else {\r\n    next()\r\n  }\r\n})\n\r\n\r\n\r\n/* eslint-disable no-new */\r\nconst vm = new Vue({\r\n  router,\r\n  store,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n\r\nwindow.App = vm\r\n\r\nexport default vm\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import {get} from '@/axios/api.js'\n\nexport default function valitoken(){\n  get('valid').then(res=>{\n    if(!res.token){\n      localStorage.removeItem('token')\n      localStorage.removeItem('username')\n      localStorage.removeItem('auth')\n      // window.location = \"/#/login\"\n      return false\n    }\n    return true\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/common/token.js","const naireRouter = [{\r\n  path: '/home',\r\n  redirect: '/home/about',\r\n  name: '问卷管理',\r\n  icon: 'el-icon-document',\r\n  component: () => import('@/views/home.vue'),\r\n  meta: {\r\n    requireAuth: true\r\n  },\r\n  children: [{\r\n      path: 'about',\r\n      name: 'about',\r\n      component: () => import('@/views/about.vue'),\r\n      meta: {\r\n        requireAuth: true\r\n      },\n      auth:1,\r\n      hidden: true\r\n    },\r\n    {\r\n      path: 'list',\r\n      name: '问卷列表',\r\n      icon: 'el-icon-reading',\r\n      component: () => import('@/views/list.vue'),\n      auth:1,\r\n      meta: {\r\n        requireAuth: true\r\n      }\r\n    },\r\n    {\r\n      path: 'create',\r\n      name: '新建问卷',\r\n      icon: 'el-icon-document-add',\r\n      component: () => import('@/views/add.vue'),\n      auth:1,\r\n      meta: {\r\n        requireAuth: true\r\n      }\r\n    },\r\n    {\r\n      path: '/edit/:id',\r\n      name: '编辑问卷',\r\n      hidden: true,\n      auth:1,\r\n      icon: 'el-icon-document-add',\r\n      component: () => import('@/views/edit.vue'),\r\n      meta: {\r\n        requireAuth: true\r\n      }\r\n    }\r\n  ]\r\n}, ]\r\n\r\nexport default naireRouter\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/stage/naireRouter.js","const adminRouter = [{\r\n  path: '',\r\n  redirect: '/home/user',\r\n  name: '用户管理',\r\n  icon: 'el-icon-user',\n  component: () => import('@/views/home.vue'),\r\n  meta: {\r\n    requireAuth: true\r\n  },\r\n  children: [\n    {\r\n      path: 'user',\r\n      name: '用户列表',\n      icon: 'el-icon-user',\r\n      component: () => import('@/views/userList.vue'),\r\n      meta: {\r\n        requireAuth: true,\r\n      },\n      auth:2\r\n    },\r\n    {\r\n      path: 'edit',\r\n      name: '修改密码',\r\n      icon: 'el-icon-reading',\n      auth:1,\r\n      component: () => import('@/views/userEdit.vue'),\r\n      meta: {\r\n        requireAuth: true\r\n      }\r\n    },\r\n  ]\r\n}, ]\r\n\r\nexport default adminRouter\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/stage/adminRouter.js","import naireRouter from './stage/naireRouter.js'\nimport adminRouter from './stage/adminRouter.js'\r\n// const login = () => import('@/views/login.vue')\r\n// const home = () => import('@/views/home.vue')\r\n\r\nconst routes = [\n  {\r\n    path: '/',\r\n    name: 'index',\r\n    meta: {\r\n      requireAuth: true\r\n    },\n    hidden:true,\r\n    redirect: '/home'\r\n  },\r\n  {\r\n    path: '/login',\r\n    name: 'login',\n    hidden:true,\r\n    component: () => import('@/views/login.vue')\r\n  },\n  {\n    path:'/register',\n    name:'登陆',\n    hidden:true,\n    component: () => import('@/views/register.vue')\n  },\n  {\n    path:'/naire/:id',\n    name:'问卷调查',\n    hidden:true,\n    component: () => import('@/views/view/naire.vue')\n  },\r\n  ...naireRouter,\n  ...adminRouter,\r\n  {\r\n    path: '*',\r\n    component: () => import('@/views/404'),\r\n    name: '404',\r\n    hidden: true\r\n  }\r\n]\r\n\r\nexport default routes\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/routes.js","import Vue from 'vue'\r\nimport Router from 'vue-router'\r\nimport routes from './routes.js'\r\n\r\nVue.use(Router)\r\n\r\nconst router = new Router({\n  routes,\r\n\tscrollBehavior: () => ({\r\n\t  y: 0,\r\n\t}),\r\n\t// base: process.env.BASE_URL,\n  linkActiveClass: 'router-active'\r\n})\r\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","// 封装axios\r\nimport axios from 'axios'\r\nimport QS from 'qs'\r\nimport router from '@/router'\r\n\r\nconst config = {\r\n  baseURL: baseURL || '',\r\n  timeout: 10 * 1000, // 请求超时时间设置\r\n  crossDomain: true,\r\n  // withCredentials: true, // Check cross-site Access-Control\r\n  // 定义可获得的http响应状态码\r\n  // return true、设置为null或者undefined，promise将resolved,否则将rejected\r\n  validateStatus(status) {\r\n    return status >= 200 && status < 510\r\n  }\r\n}\r\nconst api = axios.create(config);\r\n\r\n\r\n// http request 拦截器\r\napi.interceptors.request.use(\r\n  config => {\r\n    if (localStorage.token) { // 判断是否存在token，如果存在的话，则每个http header都加上token\r\n      config.headers.Authorization = `token ${localStorage.token}`\r\n    }\r\n    return config\r\n  },\r\n  err => {\r\n    return Promise.reject(err)\r\n  })\r\n\r\n\r\n// http response 拦截器   服务端有返回东西就不会走到error\r\napi.interceptors.response.use(\r\n  response => {\n    if( response.status == 403  ){\n      localStorage.removeItem('token')\n      localStorage.removeItem('username')\n      localStorage.removeItem('auth')\n      alert('登录失效,请重新登录')\n      router.push('/login')\n    }\r\n    return response;\r\n  },\r\n  error => {\n     console.log(error)\r\n    if (error.response) {\r\n      switch (error.response.status) {\r\n        case 403:\r\n          // 返回 403 无权限\r\n      }\r\n    }\r\n    return Promise.reject(error.response.data) // 返回接口返回的错误信息\r\n  });\r\n\r\n\r\n// 导出常用方法\r\nexport function get(url, params) {\r\n  return new Promise((resolve, reject) => {\r\n    api.get(url, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        resolve(res.data);\r\n      })\r\n      .catch(err => {\r\n        reject(err.data)\r\n      })\r\n  });\r\n}\r\n/**\r\n * post方法，对应post请求\r\n * @param {String} url [请求的url地址]\r\n * @param {Object} params [请求时携带的参数]\r\n */\r\nexport function post(url, params) {\r\n  return new Promise((resolve, reject) => {\r\n    api.post(url, QS.stringify(params))\r\n      .then(res => {\r\n        resolve(res.data);\r\n      })\r\n      .catch(err => {\r\n        reject(err.data)\r\n      })\r\n  });\r\n}\r\n\r\nexport function put(url, params) {\r\n  return new Promise((resolve, reject) => {\r\n    api.put(url, QS.stringify(params))\r\n      .then(res => {\r\n        resolve(res.data);\r\n      })\r\n      .catch(err => {\r\n        reject(err.data)\r\n      })\r\n  });\r\n}\r\n\r\nexport function _delete(url, params = {}) {\r\n  return api({\r\n    method: 'delete',\r\n    url,\r\n    params,\r\n  })\r\n}\r\n\r\n\r\n// 删除\r\n// export function _delete(url, params) {\r\n//     return new Promise((resolve, reject) => {\r\n//         axios.delete(url,{\r\n//             params: params\r\n//         })\r\n//         .then(res => {\r\n//             resolve(res.data);\r\n//         })\r\n//         .catch(err => {\r\n//             reject(err.data)\r\n//         })\r\n//     });\r\n// }\r\n\r\nexport default api\n\n\n\n// WEBPACK FOOTER //\n// ./src/axios/api.js"],"sourceRoot":""}